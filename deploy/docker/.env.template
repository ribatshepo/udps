# =============================================================================
# UDPS DOCKER DEPLOYMENT CONFIGURATION TEMPLATE
# =============================================================================
#
# This template contains all configurable environment variables for UDPS
# (Unified Data Platform Service) Docker deployments.
#
# SETUP:
#   1. Copy template:  cp .env.template .env
#   2. Generate secrets: ./setup.sh (recommended) or manually (see commands below)
#   3. Configure required values
#   4. Validate:  ./validate-config.sh --env-file .env
#   5. Deploy:   ./deploy.sh
#
# Or use the automated setup:
#   ./setup.sh          # Interactive setup (generates all secrets)
#   ./deploy.sh         # Full deployment (runs setup if .env is missing)
#
# =============================================================================
# [REQUIRED] UDPS APPLICATION SETTINGS
# =============================================================================

# UDPS version tag for the Docker image
# Override: UDPS_VERSION environment variable
UDPS_VERSION=0.1.0

# Docker image name (change for custom registries)
# Override: UDPS_IMAGE environment variable
# Examples: ghcr.io/gbmm/udps, seri-sa/udps, your-registry.com/udps
UDPS_IMAGE=seri-sa/udps

# Application log level (TRACE, DEBUG, INFO, WARN, ERROR)
UDPS_LOG_LEVEL=INFO

# =============================================================================
# [REQUIRED] DATABASE (PostgreSQL)
# =============================================================================
# PostgreSQL 16+ required. UDPS uses PostgreSQL for metadata storage,
# catalog management, and governance data.
#
# Generate password: openssl rand -base64 24 | tr -d "=+/" | cut -c1-32

# PostgreSQL connection settings
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=udps
POSTGRES_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD
POSTGRES_DB=udps_db

# Connection pool settings (optional, application defaults used if not set)
# POSTGRES_MAX_CONNECTIONS=20
# POSTGRES_IDLE_TIMEOUT=300

# =============================================================================
# [REQUIRED] REDIS CACHE
# =============================================================================
# Redis 7+ required. Used for caching query results, session data,
# and distributed locking.
#
# Generate password: openssl rand -base64 24 | tr -d "=+/" | cut -c1-32

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD

# Redis connection pool settings (optional)
# REDIS_MAX_CONNECTIONS=50
# REDIS_CONNECT_TIMEOUT=5

# =============================================================================
# [REQUIRED] MINIO OBJECT STORAGE
# =============================================================================
# MinIO provides S3-compatible object storage for data files,
# query results, and temporary storage.
#
# Generate password: openssl rand -base64 24 | tr -d "=+/" | cut -c1-32
# Note: MinIO root password must be at least 8 characters.

MINIO_HOST=minio
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_ROOT_USER=udps-admin
MINIO_ROOT_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD
MINIO_BUCKET=udps-data

# Additional MinIO buckets (optional)
# MINIO_TEMP_BUCKET=udps-temp
# MINIO_ARCHIVE_BUCKET=udps-archive

# =============================================================================
# [REQUIRED] KAFKA MESSAGE STREAMING
# =============================================================================
# Apache Kafka for event streaming, change data capture,
# and inter-service communication.

KAFKA_BOOTSTRAP_SERVERS=kafka:9092

# SASL authentication (recommended for production)
# Generate password: openssl rand -base64 24 | tr -d "=+/" | cut -c1-32
KAFKA_SASL_USERNAME=udps
KAFKA_SASL_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD

# Kafka topic configuration (optional, defaults used if not set)
# KAFKA_REPLICATION_FACTOR=1
# KAFKA_NUM_PARTITIONS=3
# KAFKA_RETENTION_MS=604800000

# =============================================================================
# [OPTIONAL] JAEGER DISTRIBUTED TRACING
# =============================================================================
# Jaeger provides distributed tracing for debugging and performance analysis.
# Disable by removing or commenting out JAEGER_HOST.

JAEGER_HOST=jaeger
JAEGER_AGENT_PORT=6831
JAEGER_COLLECTOR_PORT=14268
JAEGER_UI_PORT=16686

# Sampling rate (0.0 to 1.0, default 1.0 = trace everything)
# JAEGER_SAMPLING_RATE=1.0

# =============================================================================
# [REQUIRED] HOST PORT MAPPINGS
# =============================================================================
# Ports exposed on the Docker host. Change these if defaults conflict
# with other services on your machine.

# gRPC API port (primary API interface)
UDPS_GRPC_PORT=50060

# HTTPS REST API port (alternative HTTP/2 interface)
UDPS_HTTPS_PORT=8443

# Prometheus metrics endpoint
UDPS_METRICS_PORT=9090

# Health check endpoint (liveness + readiness probes)
UDPS_HEALTH_PORT=8081

# =============================================================================
# [OPTIONAL] TLS CONFIGURATION
# =============================================================================
# Paths inside the container for TLS certificates.
# The setup script generates self-signed certificates automatically.
# For production, provide your own certificates via volume mounts.

TLS_CERT_PATH=/app/certs/server.crt
TLS_KEY_PATH=/app/certs/server.key
TLS_CA_PATH=/app/certs/ca.crt

# Provide external certificates (overrides self-signed generation in setup.sh):
# TLS_EXTERNAL_CERT=/path/to/your/cert.pem
# TLS_EXTERNAL_KEY=/path/to/your/key.pem
# TLS_EXTERNAL_CA=/path/to/your/ca.pem

# =============================================================================
# [OPTIONAL] OBSERVABILITY
# =============================================================================

# Prometheus scrape configuration
# METRICS_ENABLED=true
# METRICS_PATH=/metrics

# Structured logging format (json, text)
# LOG_FORMAT=json

# Log output destination (stdout, file)
# LOG_OUTPUT=stdout

# =============================================================================
# [DEVELOPMENT ONLY] SECURITY RELAXATIONS
# =============================================================================
# Uncomment these ONLY for local development. NEVER use in production.

# Disable TLS verification for self-signed certs
# TLS_INSECURE_SKIP_VERIFY=true

# Enable debug endpoints
# DEBUG_ENABLED=true

# Verbose query logging
# QUERY_LOG_LEVEL=DEBUG

# =============================================================================
# QUICK SETUP - Generate All Required Secrets
# =============================================================================
# Run these commands to generate secure random values:
#
#   POSTGRES_PW=$(openssl rand -base64 24 | tr -d "=+/" | cut -c1-32)
#   REDIS_PW=$(openssl rand -base64 24 | tr -d "=+/" | cut -c1-32)
#   MINIO_PW=$(openssl rand -base64 24 | tr -d "=+/" | cut -c1-32)
#   KAFKA_PW=$(openssl rand -base64 24 | tr -d "=+/" | cut -c1-32)
#
#   echo "POSTGRES_PASSWORD=$POSTGRES_PW"
#   echo "REDIS_PASSWORD=$REDIS_PW"
#   echo "MINIO_ROOT_PASSWORD=$MINIO_PW"
#   echo "KAFKA_SASL_PASSWORD=$KAFKA_PW"
#
# Or use the automated setup script:
#   ./setup.sh
#
